<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:uiform>
   <head>
      <!---------------------------------------------------------->
      <!----------------- HOME DE LA APLICACION ------------------>
      <!---------------------------------------------------------->
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      
       <!-- Latest compiled and minified CSS -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
      <!-- jQuery library -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      <!-- Latest compiled JavaScript -->
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      <!-- Valildator -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.9/validator.min.js"></script>

      <!-- D3 graphics -->
      <script src="https://d3js.org/d3.v4.min.js"></script>
      <script language="Javascript" src="/stock-alerts/pages/js/chartUtils.js"> </script>

      <script language="Javascript" src="/stock-alerts/pages/js/httpUtils.js"> </script>
      
      <script language="Javascript">
         
         function startup(){
           
         }

         function consult( event ){
             //avoids default submit process
             event.preventDefault();
        	    var tickerInput = document.getElementById( "tickerSymbol" );
        	    var historyCheckbox = document.getElementById( "historyCheckbox" );
             var url = "/stock-alerts/stocks" + (historyCheckbox.checked? "/history" :"") + "?symbol=" + tickerInput.value;
             httpGetAsync( url, function( result ){ 
                 document.getElementById( "resultDiv" ).innerHTML = result; 
                 var history;
                 var resultObject = JSON.parse(result);
                 if( historyCheckbox.checked ){
                     history = resultObject;
                 }else{
                	  history = resultObject.stock.history
                 }
                 createChart(history, "visualisation", "date", "close");
             } );
         }

      </script>
   </head>
   
   <body onload="startup();" style="overflow: auto; margin: 0px; border: 0px;" >
   <div class="container">
      <h2>Stocks</h2>
	   <form data-toggle="validator" name="stocksForm" id="stocksForm" onsubmit="consult(event)">
		  <div class="form-group">
		    <label for="tickerSymbol">Ticker Symbol</label>
		    <input type="text" class="form-control" id="tickerSymbol" aria-describedby="symbolHelp" placeholder="TSLA" required data-minlength="1">
		    <small id="symbolHelp" class="form-text text-muted">Use Yahoo notation (".BA" for Buenos Aires stocks)</small>
		  </div>
		  <div class="checkbox">
	        <label><input id="historyCheckbox" type="checkbox"> Get history</label>
	     </div>
	     <div class="form-group">
		    <button type="submit" class="btn btn-primary">Consult</button>
		  </div>
		</form>
		<div id="resultDiv">
		</div>
		<svg id="visualisation" width="1000" height="500"></svg>
	</div>
	
   </body>
</html>